### Хранение и распространение видео контента
Все это работает по принципу торрентов, только эффективнее, т.к. каждое видео или видео поток(стрим) делится на мелкие фрагменты по 8 секунд по спецификации HLS. Это дает возможность смотреть видео не загружая его полностью, а только с нужного момента. 
Информация о каждом фрагменте фиксируется и указыается связь с предыдущим фрагментом, в результате чего мы получаем цепочку видео фрагментов которые связаны между собой. Изначально фрагменты хранит только Создатель, после того как Пользователь получил фрагмент он становится автоматически Распространителем. 

### Стримминг
Видео поток который создается и распространяется в режиме реального времени (Twich формат).
Перед созданием трансляции видео потока создается комната с названием трансляции в которую поступает информация о новых фрагментах.  
Далее Создатель генерирует фрагменты длительностью по 8 секунд, отправляя информацию о каждом фрагменте в комнату трансляции, Пользователь видит новый фрагмент видео в этой комнате и загружает напрямую от Создатель. Каждый кто скачал фрагмент становится его распространителем. Т.е. изначально фрагмент есть только у Создателя. Перый человек скачивает с него. Второй уже скачивает с создателя и первого, третий у создателя, первого и второго, и т.д. до 8. Ограничение на одновременное скачивание сделано, чтобы не перегружать узлы, и не перегружать свою сеть по количеству соединений. В результате в начале Создатель один распространяет свои видео фрагменты, после того как фрагмент получил хоть один Пользователь он перестает быть единственным Распространитель и нагрузка сильно снижается на узел, видео грузится очень быстро.

![](images/video_creator.jpg)

Видео фрагмент хранится у каждого Распространителя до тех пор пока выделеное место не закончится или просто его долгое время никто не запрашивает. Эта модель используется для видео стримминга, т.к. далеко не все лайвы нужно хранить. 
Однако, если бы любая информация пропадала через каео-то время, это очень быстро вылилось бы в серьёзную проблему. Ведь бывают ситуации, или эпизоды во время живых трансляций, которые обладают особенной ценностью и с течением времени не утрачивают акутальность. Такой контент может и должен храниться ровно столько, сколько пожелает автор, или его сообещство. И мы, разумеется, подумали о том, как реализовать бессрочное хранение контента. Для этого мы разработали роль так называемого Супер-Распространителя. С технической точки зрения - это узел, который постоянно находится онлайн и обладает огромными (по сравнению с обычными пользователями) объёмами хранилищ данных. Любой создатель контента может обратиться к супер-распространителю и взять в аренду определённый объём места, где разместить ценный для него контент. В системе такой контент будет маркерован определённым образом и автоматически удалён, или заменён не будет никогда. 
С другой стороны, если всё оставить так, как мы только что описали, это неизбежно приведёт к централизации и увеличения влияния супер-распространителей по мере накопления ценных данных на своих жестких дисках. В долгосрочной перспективе это приведёт к ситуации, схожей с текущим положением дел - авторы опять окажутся в зависимости от воли третей стороны (в данном случае супер-распространителей), поскольку значительная доля их контента будет у этих людей. Об это мы тоже, конечно же, позаботились. Для исключения возможности искуственной централизации, во-первых, автор может одновременно разместить информацию у любого количества супер-распространителей (например у 5, или 10), во-вторых, функция супер-распространителя будет доступна абсолютно любому пользователю. Для того, чтобы взять на себя данную роль, нужно будет лишь обеспечить соответствие определённым требованиям по нахождению онлайн и возможностям хранения (Например, если у вас есть старая машина, лежащая без дела, вы сможете отрядить её под функцию хранения, и из бесполезного хлама она станет источником развития сообщества вашего любимого стримера/блогера, и источником пассивного дохода для вас). 
В контексте сообщества это означает, что аудитория сможет поддерживать своего любимого блогера или автора не только регулярными просмотрами и донатами, но и храненинем его контента. Наши алгоритмы распределения позволяют сделать так, чтобы большие объёмы (например 24/48 часовые марафоны) распределялись между всем сообществом равномерно, снимая нагрузку по требованиям к отдельному пользователю. Так же сам факт того, что информация будет находиться у большого количества пользователей снимает жесткость требования к онлайну - посколькуо чем больше людей, тем меньше вероятность, что все одновременно будут оффлайн. А для полноценной работы нашей системы достаточно, чтобы онлайн был всего лишь один человек!


### Логика распределения и хранение информации

Поскольку технология распределяет информацию между пользователями, каждому пользователю необходимо выделять какое-то количество места на своём жестком диске для хранения. 
Объём выделяется по желанию пользователя и может быть изменём впоследствии.
При исчерпании отведенного пространства самая неактуальная информация заменяется на новую. Система будет сообщать об исчерпании лимита и предлагать выбрать дальнейшее действие. (Увеличить выделенный объём, заменить наиболее старые/неактуальные файлы, или обратиться к супер-распространителю)
Чтобы защитить фрагмент информации от случайного удаления пользователь может выбрать функцию "резервирвоания", что промаркерует фрагмент как невозможный для удаления. 
Для того, чтобы информация была доступна для скачивания другим пользователям, хранитель должен быть онлайн.
